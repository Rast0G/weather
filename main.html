<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<link rel="stylesheet" href="./weather.css">
</head>
<body>
	<div class="js-html">
	
	</div>

	<script>
		const lat = '48.7172272';
		const lon = '21.2496774';
		const appid = '84762e6c3fa09b7f49dd16d20b6543d0'

		//getWeather(lat,lon,appid)
		showData();

		async function getWeather(lat, lon, appid) {
			try {
				const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${appid}&units=metric`);
				const data = await response.json();
				console.log(data); // now this is the real weather data
				showData(data);
			} catch (err) {
				console.error('Fetch error:', err);
			}
		}

		function showData(data=null) {
			/*
			const name = data.name;
			const temp = Math.round(data.main.temp);
			const tempFeels = Math.round(data.main.feels_like);
			const humidity = data.main.humidity;
			const wind = data.wind.speed
			const windDir = data.wind.deg
			const main = data.weather.main;
			const desc = data.weather.description;
			*/

			const name = 'Kosice';
			const temp = 13;
			const tempFeels = 11;
			const humidity = 60;
			const wind = 2
			const deg = 360
			const compas = dirToCompass(deg)
			console.log(compas)
			const predp = compas === 'severu' || compas === 'severovýchodu' || compas === 'západu' || compas === 'severozápadu' ? 'zo' :'z';


			html = `
				<h2>${name}</h2>
				<h1>${temp}&#xb0</h1>
				<p>Pocitová teplota je ${tempFeels}&#xb0</p>
				<div class="wind">
					<p style="display: inline-block;">Rýchlosť vetra je ${wind} m/s ${predp} ${compas}</p>
					<div style="transform: rotate(${deg}deg);" class="wind-arrow">&#x2193;</div>
				</div>
				<div class="humidity-bar">
					<div class="humidity-value" style="width: ${humidity}%;">
					</div>
				</div>
			`;
			document.querySelector('.js-html').innerHTML = html;
		}

		function dirToCompass (deg) {
			const compas = ['severu', 'severovýchodu', 'východu', 'juhovýchodu', 'juhu', 'juhozápadu', 'západu', 'severozápadu'];
			return compas[Math.round((deg/45)%8)];
		}

	</script>
</body>
</html>